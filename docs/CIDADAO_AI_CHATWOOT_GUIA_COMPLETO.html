<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CidadÃ£o.AI - Chatwoot - Guia Completo de ImplementaÃ§Ã£o</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            text-align: center;
        }
        h2 {
            color: #34495e;
            border-left: 4px solid #3498db;
            padding-left: 15px;
            margin-top: 30px;
        }
        h3 {
            color: #2980b9;
            margin-top: 25px;
        }
        h4 {
            color: #7f8c8d;
            margin-top: 20px;
        }
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }
        .status-completed {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status-working {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .status-pending {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }
        .command {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 10px;
            border-radius: 5px;
            margin: 5px 0;
            font-family: 'Courier New', monospace;
        }
        .warning {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #ffc107;
        }
        .success {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #28a745;
        }
        .error {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #dc3545;
        }
        .architecture-diagram {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 10px;
        }
        .flow-step {
            background-color: #e3f2fd;
            border: 1px solid #bbdefb;
            border-radius: 5px;
            padding: 10px;
            margin: 5px 0;
            position: relative;
        }
        .flow-step::before {
            content: "â†’";
            position: absolute;
            left: -20px;
            color: #1976d2;
            font-weight: bold;
        }
        .tech-stack {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .tech-item {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }
        .endpoint {
            background-color: #f1f3f4;
            border: 1px solid #dadce0;
            border-radius: 5px;
            padding: 10px;
            margin: 5px 0;
            font-family: 'Courier New', monospace;
        }
        .endpoint .method {
            font-weight: bold;
            color: #1a73e8;
        }
        .endpoint .path {
            color: #137333;
        }
        .todo-list {
            background-color: #f8f9fa;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
        }
        .todo-item {
            margin: 8px 0;
            padding: 5px;
            border-radius: 3px;
        }
        .todo-completed {
            background-color: #d4edda;
            text-decoration: line-through;
            opacity: 0.7;
        }
        .todo-pending {
            background-color: #fff3cd;
        }
        .file-structure {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
        }
        .toc {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 20px;
            margin: 20px 0;
        }
        .toc ul {
            list-style-type: none;
            padding-left: 0;
        }
        .toc li {
            margin: 5px 0;
        }
        .toc a {
            text-decoration: none;
            color: #007bff;
        }
        .toc a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ CidadÃ£o.AI - Chatwoot Integration</h1>
        <h2 style="text-align: center; color: #27ae60; border: none;">Guia Completo de ImplementaÃ§Ã£o e DocumentaÃ§Ã£o</h2>
        
        <div class="success">
            <strong>âœ… Status do Projeto:</strong> Sistema funcionando perfeitamente! Todas as funcionalidades implementadas e testadas com sucesso.
        </div>

        <div class="toc">
            <h3>ğŸ“‹ Ãndice</h3>
            <ul>
                <li><a href="#overview">1. VisÃ£o Geral do Projeto</a></li>
                <li><a href="#architecture">2. Arquitetura do Sistema</a></li>
                <li><a href="#tech-stack">3. Stack TecnolÃ³gico</a></li>
                <li><a href="#features">4. Funcionalidades Implementadas</a></li>
                <li><a href="#api-endpoints">5. Endpoints da API</a></li>
                <li><a href="#deployment">6. Deploy e ConfiguraÃ§Ã£o</a></li>
                <li><a href="#troubleshooting">7. SoluÃ§Ã£o de Problemas</a></li>
                <li><a href="#next-steps">8. PrÃ³ximos Passos</a></li>
                <li><a href="#appendix">9. Anexos TÃ©cnicos</a></li>
            </ul>
        </div>

        <h2 id="overview">1. ğŸ¯ VisÃ£o Geral do Projeto</h2>
        
        <p>O <strong>CidadÃ£o.AI - Chatwoot Integration</strong> Ã© um sistema completo que integra WhatsApp com Chatwoot para atendimento tÃ©cnico, permitindo:</p>
        
        <ul>
            <li><strong>Recebimento de mensagens</strong> do WhatsApp via Chatwoot</li>
            <li><strong>Interface web</strong> para tÃ©cnicos responderem mensagens</li>
            <li><strong>Processamento de mÃ­dia</strong> (Ã¡udio e imagens)</li>
            <li><strong>IntegraÃ§Ã£o com IA</strong> para respostas automÃ¡ticas</li>
            <li><strong>AtualizaÃ§Ãµes em tempo real</strong> via WebSocket</li>
        </ul>

        <div class="architecture-diagram">
            <h3>ğŸ”„ Fluxo Principal</h3>
            <div class="flow-step">WhatsApp â†’ Chatwoot</div>
            <div class="flow-step">Chatwoot â†’ Webhook (CidadÃ£o.AI)</div>
            <div class="flow-step">Webhook â†’ Processamento de MÃ­dia</div>
            <div class="flow-step">Processamento â†’ WebSocket (Frontend)</div>
            <div class="flow-step">TÃ©cnico â†’ Frontend â†’ Chatwoot â†’ WhatsApp</div>
        </div>

        <h2 id="architecture">2. ğŸ—ï¸ Arquitetura do Sistema</h2>

        <div class="file-structure">
cidadaoai-chatwoot/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ main.py                 # API principal e webhooks
â”‚   â”œâ”€â”€ websocket_manager.py    # Gerenciamento WebSocket
â”‚   â”œâ”€â”€ media_handler.py        # Processamento de Ã¡udio
â”‚   â”œâ”€â”€ audio_transcriber.py    # TranscriÃ§Ã£o com OpenAI Whisper
â”‚   â”œâ”€â”€ attachment_service.py   # Processamento de imagens
â”‚   â”œâ”€â”€ models.py              # Modelos Pydantic
â”‚   â””â”€â”€ database.py            # ConexÃ£o com banco
â”œâ”€â”€ frontend/
â”‚   â””â”€â”€ tecnico/
â”‚       â”œâ”€â”€ index.html         # Interface principal
â”‚       â””â”€â”€ js/
â”‚           â”œâ”€â”€ app.js         # LÃ³gica do frontend
â”‚           â””â”€â”€ config.js      # ConfiguraÃ§Ãµes
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ schema.sql            # Schema do banco
â”œâ”€â”€ docker-compose.yml        # ConfiguraÃ§Ã£o Docker
â”œâ”€â”€ Dockerfile               # Imagem Docker
â”œâ”€â”€ requirements.txt         # DependÃªncias Python
â””â”€â”€ .env                    # VariÃ¡veis de ambiente
        </div>

        <h2 id="tech-stack">3. ğŸ› ï¸ Stack TecnolÃ³gico</h2>

        <div class="tech-stack">
            <div class="tech-item">
                <h4>Backend</h4>
                <ul>
                    <li><strong>FastAPI</strong> - Framework web moderno</li>
                    <li><strong>Python 3.11</strong> - Linguagem principal</li>
                    <li><strong>Socket.IO</strong> - WebSocket para tempo real</li>
                    <li><strong>httpx</strong> - Cliente HTTP assÃ­ncrono</li>
                </ul>
            </div>
            <div class="tech-item">
                <h4>Frontend</h4>
                <ul>
                    <li><strong>HTML5 + CSS3</strong> - Interface web</li>
                    <li><strong>Tailwind CSS</strong> - Framework CSS</li>
                    <li><strong>JavaScript ES6+</strong> - LÃ³gica frontend</li>
                    <li><strong>Socket.IO Client</strong> - ComunicaÃ§Ã£o real-time</li>
                </ul>
            </div>
            <div class="tech-item">
                <h4>Infraestrutura</h4>
                <ul>
                    <li><strong>Docker + Docker Swarm</strong> - ContainerizaÃ§Ã£o</li>
                    <li><strong>PostgreSQL + pgvector</strong> - Banco de dados</li>
                    <li><strong>Redis</strong> - Cache e sessÃµes</li>
                    <li><strong>Traefik</strong> - Proxy reverso</li>
                </ul>
            </div>
            <div class="tech-item">
                <h4>IntegraÃ§Ãµes</h4>
                <ul>
                    <li><strong>Chatwoot API</strong> - Sistema de chat</li>
                    <li><strong>OpenAI Whisper</strong> - TranscriÃ§Ã£o de Ã¡udio</li>
                    <li><strong>WhatsApp Business API</strong> - Mensagens</li>
                    <li><strong>FFmpeg</strong> - Processamento de mÃ­dia</li>
                </ul>
            </div>
        </div>

        <h2 id="features">4. âœ¨ Funcionalidades Implementadas</h2>

        <h3>4.1 Sistema de Mensagens <span class="status-badge status-completed">âœ… COMPLETO</span></h3>
        <ul>
            <li>âœ… Recebimento de mensagens via webhook do Chatwoot</li>
            <li>âœ… Envio de mensagens para Chatwoot/WhatsApp</li>
            <li>âœ… Interface web para tÃ©cnicos</li>
            <li>âœ… AtualizaÃ§Ãµes em tempo real via WebSocket</li>
        </ul>

        <h3>4.2 Processamento de Ãudio <span class="status-badge status-completed">âœ… COMPLETO</span></h3>
        <ul>
            <li>âœ… Download automÃ¡tico de Ã¡udios do Chatwoot</li>
            <li>âœ… Player de Ã¡udio no frontend</li>
            <li>âœ… GravaÃ§Ã£o via microfone no frontend</li>
            <li>âœ… ConversÃ£o para formatos compatÃ­veis com WhatsApp</li>
            <li>âœ… TranscriÃ§Ã£o com OpenAI Whisper (configurÃ¡vel)</li>
        </ul>

        <h3>4.3 Processamento de Imagens <span class="status-badge status-completed">âœ… COMPLETO</span></h3>
        <ul>
            <li>âœ… DetecÃ§Ã£o automÃ¡tica de imagens nos webhooks</li>
            <li>âœ… ExibiÃ§Ã£o de imagens no frontend</li>
            <li>âœ… Upload de imagens via frontend</li>
            <li>âœ… PersistÃªncia de imagens ao trocar conversas</li>
            <li>âœ… Modal para visualizaÃ§Ã£o em tela cheia</li>
        </ul>

        <h3>4.4 Interface Web <span class="status-badge status-completed">âœ… COMPLETO</span></h3>
        <ul>
            <li>âœ… Lista de conversas em tempo real</li>
            <li>âœ… Chat interface responsiva</li>
            <li>âœ… Indicadores de status (enviado, entregue, lido)</li>
            <li>âœ… Busca e filtros de conversas</li>
            <li>âœ… Interface para envio de mÃ­dia</li>
        </ul>

        <h3>4.5 IntegraÃ§Ã£o com IA <span class="status-badge status-completed">âœ… COMPLETO</span></h3>
        <ul>
            <li>âœ… Processamento automÃ¡tico de mensagens</li>
            <li>âœ… Respostas automÃ¡ticas via OpenAI</li>
            <li>âœ… TranscriÃ§Ã£o de Ã¡udio com Whisper</li>
            <li>âœ… ConfiguraÃ§Ã£o flexÃ­vel de prompts</li>
        </ul>

        <h2 id="api-endpoints">5. ğŸ”Œ Endpoints da API</h2>

        <h3>5.1 Endpoints Principais</h3>
        
        <div class="endpoint">
            <span class="method">GET</span> <span class="path">/</span> - PÃ¡gina principal (frontend)
        </div>
        
        <div class="endpoint">
            <span class="method">GET</span> <span class="path">/health</span> - Status da API
        </div>
        
        <div class="endpoint">
            <span class="method">POST</span> <span class="path">/webhook/chatwoot</span> - Webhook do Chatwoot
        </div>

        <h3>5.2 API para Frontend</h3>
        
        <div class="endpoint">
            <span class="method">GET</span> <span class="path">/api/conversations</span> - Listar conversas
        </div>
        
        <div class="endpoint">
            <span class="method">GET</span> <span class="path">/api/conversations/{id}/messages</span> - Mensagens da conversa
        </div>
        
        <div class="endpoint">
            <span class="method">POST</span> <span class="path">/api/conversations/{id}/messages</span> - Enviar mensagem
        </div>
        
        <div class="endpoint">
            <span class="method">POST</span> <span class="path">/api/conversations/{id}/voice</span> - Enviar Ã¡udio
        </div>
        
        <div class="endpoint">
            <span class="method">POST</span> <span class="path">/api/conversations/{id}/image</span> - Enviar imagem
        </div>

        <h3>5.3 WebSocket Events</h3>
        
        <div class="code-block">
// Eventos enviados pelo servidor:
- new_message: Nova mensagem recebida
- conversation_update: AtualizaÃ§Ã£o de conversa
- typing_status: Status de digitaÃ§Ã£o

// Eventos enviados pelo cliente:
- join_conversation: Entrar em uma conversa
- leave_conversation: Sair de uma conversa
        </div>

        <h2 id="deployment">6. ğŸš€ Deploy e ConfiguraÃ§Ã£o</h2>

        <h3>6.1 ConfiguraÃ§Ã£o do Ambiente</h3>

        <div class="command">
# 1. Clonar repositÃ³rio
git clone https://github.com/valleteclab/cidadaoai-chatwoot.git
cd cidadaoai-chatwoot

# 2. Configurar variÃ¡veis de ambiente
cp env.template .env
# Editar .env com suas configuraÃ§Ãµes
        </div>

        <h3>6.2 VariÃ¡veis de Ambiente NecessÃ¡rias</h3>

        <div class="code-block">
# Chatwoot
CHATWOOT_API_URL=https://chat.sisgov.app.br
CHATWOOT_API_TOKEN=seu_token_aqui
CHATWOOT_ACCOUNT_ID=1

# OpenAI (opcional)
OPENAI_API_KEY=sk-proj-...

# Banco de dados
DATABASE_URL=postgresql://user:pass@host:port/db

# Redis
REDIS_URL=redis://host:port

# Servidor
HOST=0.0.0.0
PORT=8000
        </div>

        <h3>6.3 Deploy com Docker Swarm</h3>

        <div class="command">
# 1. Fazer build da imagem
docker build -t cidadaoai:latest .

# 2. Deploy do stack
docker stack deploy -c docker-compose.yml cidadaoai

# 3. Verificar status
docker service ls --filter name=cidadaoai
        </div>

        <h3>6.4 ConfiguraÃ§Ã£o do Chatwoot</h3>

        <div class="warning">
            <strong>âš ï¸ Importante:</strong> Configure o webhook no Chatwoot apontando para:
            <br><code>https://tecnico.sisgov.app.br/webhook/chatwoot</code>
        </div>

        <h2 id="troubleshooting">7. ğŸ”§ SoluÃ§Ã£o de Problemas</h2>

        <h3>7.1 Problemas Comuns e SoluÃ§Ãµes</h3>

        <div class="error">
            <h4>âŒ Erro: "ModuleNotFoundError: No module named 'backend'"</h4>
            <p><strong>SoluÃ§Ã£o:</strong> Execute o update no servidor:</p>
            <div class="command">./update-server.sh</div>
        </div>

        <div class="error">
            <h4>âŒ Erro: "ValidationError: conversation_id Input should be a valid integer"</h4>
            <p><strong>SoluÃ§Ã£o:</strong> JÃ¡ corrigido - modelo ChatwootAttachment atualizado.</p>
        </div>

        <div class="error">
            <h4>âŒ Imagens nÃ£o aparecem ao trocar de conversas</h4>
            <p><strong>SoluÃ§Ã£o:</strong> JÃ¡ corrigido - API agora retorna image_attachments.</p>
        </div>

        <h3>7.2 Logs Importantes</h3>

        <div class="code-block">
# Verificar logs do serviÃ§o
docker service logs -f cidadaoai_cidadaoai_app

# Logs importantes para debug:
- "âœ… Attachment detectado como imagem por MIME: image"
- "ğŸ–¼ï¸ Processadas X imagens para mensagem Y"
- "ğŸ“¨ Nova mensagem recebida via WebSocket"
        </div>

        <h3>7.3 Comandos de Debug</h3>

        <div class="command">
# Testar conectividade da API
curl https://tecnico.sisgov.app.br/health

# Verificar status do serviÃ§o
docker service ps cidadaoai_cidadaoai_app

# Rebuild da imagem
docker build -t cidadaoai:latest .
docker service update --image cidadaoai:latest cidadaoai_cidadaoai_app
        </div>

        <h2 id="next-steps">8. ğŸ¯ PrÃ³ximos Passos</h2>

        <div class="todo-list">
            <h3>Tarefas Pendentes</h3>
            
            <div class="todo-item todo-pending">
                <h4>ğŸ”§ Melhorias TÃ©cnicas</h4>
                <ul>
                    <li>Implementar cache Redis para melhor performance</li>
                    <li>Adicionar autenticaÃ§Ã£o/autorizaÃ§Ã£o</li>
                    <li>Implementar rate limiting</li>
                    <li>Adicionar logs estruturados (JSON)</li>
                </ul>
            </div>

            <div class="todo-item todo-pending">
                <h4>ğŸ“± Funcionalidades</h4>
                <ul>
                    <li>Suporte a outros tipos de mÃ­dia (vÃ­deo, documentos)</li>
                    <li>NotificaÃ§Ãµes push para novas mensagens</li>
                    <li>HistÃ³rico de conversas com paginaÃ§Ã£o</li>
                    <li>ExportaÃ§Ã£o de relatÃ³rios</li>
                </ul>
            </div>

            <div class="todo-item todo-pending">
                <h4>ğŸ¨ Interface</h4>
                <ul>
                    <li>Modo escuro/claro</li>
                    <li>PersonalizaÃ§Ã£o de temas</li>
                    <li>Atalhos de teclado</li>
                    <li>Interface mobile otimizada</li>
                </ul>
            </div>

            <div class="todo-item todo-pending">
                <h4>ğŸ¤– IA AvanÃ§ada</h4>
                <ul>
                    <li>AnÃ¡lise de sentimento das mensagens</li>
                    <li>ClassificaÃ§Ã£o automÃ¡tica de tickets</li>
                    <li>Respostas baseadas em contexto</li>
                    <li>IntegraÃ§Ã£o com outros modelos de IA</li>
                </ul>
            </div>
        </div>

        <h2 id="appendix">9. ğŸ“š Anexos TÃ©cnicos</h2>

        <h3>9.1 Estrutura do Banco de Dados</h3>

        <div class="code-block">
-- Tabela para armazenar mensagens
CREATE TABLE messages (
    id SERIAL PRIMARY KEY,
    chatwoot_message_id INTEGER UNIQUE,
    conversation_id INTEGER,
    content TEXT,
    message_type VARCHAR(50),
    sender_type VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Tabela para attachments processados
CREATE TABLE attachments (
    id SERIAL PRIMARY KEY,
    chatwoot_attachment_id INTEGER,
    message_id INTEGER,
    file_type VARCHAR(100),
    filename VARCHAR(255),
    file_size INTEGER,
    data_url TEXT,
    processed_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
        </div>

        <h3>9.2 ConfiguraÃ§Ã£o do Traefik</h3>

        <div class="code-block">
# Labels para Docker Swarm
traefik.enable=true
traefik.http.routers.cidadaoai.rule=Host(`tecnico.sisgov.app.br`)
traefik.http.routers.cidadaoai.entrypoints=websecure
traefik.http.routers.cidadaoai.tls.certresolver=letsencrypt
traefik.http.services.cidadaoai.loadbalancer.server.port=8000
        </div>

        <h3>9.3 Scripts Ãšteis</h3>

        <h4>Comandos para Acesso ao Servidor</h4>
        <div class="code-block">
# Acessar o servidor
ssh root@212.85.0.166

# Navegar para o diretÃ³rio do projeto
cd /root/projetos/cidadaoai-chatwoot

# Ativar ambiente virtual (se necessÃ¡rio)
source venv/bin/activate

# Executar atualizaÃ§Ã£o do servidor
./update-server.sh
        </div>

        <h4>update-server.sh</h4>
        <div class="code-block">
#!/bin/bash
# Script para atualizar o serviÃ§o no Docker Swarm

SERVICE_NAME="cidadaoai_cidadaoai_app"
STACK_NAME="cidadaoai"
IMAGE_NAME="cidadaoai:latest"

echo "ğŸš€ Iniciando atualizaÃ§Ã£o do serviÃ§o $SERVICE_NAME..."

# 1. Parar e remover o serviÃ§o existente
docker service rm $SERVICE_NAME || true

# 2. Fazer git pull
git pull origin main

# 3. Reconstruir a imagem Docker
docker build -t $IMAGE_NAME .

# 4. Deploy do stack atualizado
docker stack deploy -c docker-compose.yml $STACK_NAME

# 5. Verificar status
docker service ls --filter name=$SERVICE_NAME

echo "ğŸ‰ AtualizaÃ§Ã£o concluÃ­da!"
        </div>

        <h4>Processo Completo de Deploy</h4>
        <div class="code-block">
# 1. Local - Commit e Push das mudanÃ§as
git add .
git commit -m "DescriÃ§Ã£o das mudanÃ§as"
git push origin main

# 2. Servidor - SSH e Deploy
ssh root@212.85.0.166
cd /root/projetos/cidadaoai-chatwoot
git pull origin main
./update-server.sh

# 3. Verificar status do serviÃ§o
docker service ls --filter name=cidadaoai

# 4. Ver logs em tempo real
docker service logs -f cidadaoai_cidadaoai_app
        </div>

        <h4>Monitoramento da IA</h4>
        <div class="code-block">
# Verificar status da IA (recomendado)
./check_ai_status.sh

# Monitorar apenas logs da IA (filtrado)
./monitor_ai_logs.sh

# Verificar status via API
curl https://tecnico.sisgov.app.br/api/agent/status

# Debug completo da IA
curl https://tecnico.sisgov.app.br/api/agent/debug
        </div>

        <h3>9.4 Monitoramento</h3>

        <div class="code-block">
# Comandos para monitoramento
docker service logs -f cidadaoai_cidadaoai_app
docker service ps cidadaoai_cidadaoai_app
docker stats $(docker ps -q --filter "name=cidadaoai")

# MÃ©tricas importantes:
- Uso de CPU e memÃ³ria
- LatÃªncia das requisiÃ§Ãµes
- Taxa de erro dos webhooks
- NÃºmero de conexÃµes WebSocket ativas
        </div>

        <h3>9.5 Backup e RecuperaÃ§Ã£o</h3>

        <div class="code-block">
# Backup do banco de dados
docker exec cidadaoai_postgres pg_dump -U postgres cidadaoai > backup_$(date +%Y%m%d_%H%M%S).sql

# Backup dos arquivos de mÃ­dia
tar -czf media_backup_$(date +%Y%m%d_%H%M%S).tar.gz ./media/

# Restaurar backup
docker exec -i cidadaoai_postgres psql -U postgres cidadaoai < backup_file.sql
        </div>

        <div class="todo-item todo-completed">
            <h3>ğŸ« Sistema de Chamados CidadÃ£os - FASE 1 âœ…</h3>
            <p><strong>Implementado em 28/12/2024:</strong></p>
            <ul>
                <li>âœ… Schema completo do banco de dados</li>
                <li>âœ… Sistema de cadastro automÃ¡tico de cidadÃ£os</li>
                <li>âœ… GeraÃ§Ã£o automÃ¡tica de protocolos Ãºnicos</li>
                <li>âœ… CategorizaÃ§Ã£o inteligente de chamados</li>
                <li>âœ… IA especializada para fluxo de atendimento</li>
                <li>âœ… Endpoints completos de API</li>
                <li>âœ… IntegraÃ§Ã£o com sistema existente</li>
                <li>âœ… Frontend administrativo</li>
                <li>âœ… DocumentaÃ§Ã£o completa</li>
            </ul>
            <p><strong>Funcionalidades:</strong></p>
            <ul>
                <li>ğŸ¤– IA coleta dados do cidadÃ£o automaticamente</li>
                <li>ğŸ“‹ Cria protocolos Ãºnicos (ex: INFRA-2024-001)</li>
                <li>ğŸ¢ Categoriza chamados por secretaria</li>
                <li>â° Define SLA automÃ¡tico por categoria</li>
                <li>ğŸ“Š Dashboard com mÃ©tricas em tempo real</li>
                <li>ğŸ” Consulta de status via WhatsApp</li>
                <li>ğŸ–¥ï¸ Interface administrativa completa</li>
            </ul>
            <p><strong>DocumentaÃ§Ã£o:</strong></p>
            <ul>
                <li><a href="docs/MANUAL_COMPLETO_SISTEMA.md" target="_blank">ğŸ“š Manual Completo do Sistema</a></li>
                <li><a href="docs/TROUBLESHOOTING.md" target="_blank">ğŸ”§ Guia de Troubleshooting</a></li>
                <li><a href="COMANDOS_RAPIDOS.md" target="_blank">âš¡ Comandos RÃ¡pidos</a></li>
                <li><a href="docs/MANUAL_IMPLEMENTACAO_FASE1.md" target="_blank">ğŸ“‹ Manual de ImplementaÃ§Ã£o</a></li>
            </ul>
        </div>

        <div class="todo-item todo-completed">
            <h3>ğŸ¤– Construtor de Agentes IA âœ…</h3>
            <p><strong>Implementado em 29/12/2024:</strong></p>
            <ul>
                <li>âœ… Interface visual para criaÃ§Ã£o de agentes</li>
                <li>âœ… Editor de prompts avanÃ§ado</li>
                <li>âœ… Configurador de agentes (categoria, SLA, prioridade)</li>
                <li>âœ… Simulador de conversa em tempo real</li>
                <li>âœ… Templates prÃ©-definidos por categoria</li>
                <li>âœ… APIs completas para gerenciamento</li>
                <li>âœ… Sistema de teste e mÃ©tricas</li>
            </ul>
            <p><strong>Funcionalidades:</strong></p>
            <ul>
                <li>ğŸ¨ Interface drag & drop para configuraÃ§Ãµes</li>
                <li>âš¡ Desenvolvimento 10x mais rÃ¡pido</li>
                <li>ğŸ‘¥ Acesso para nÃ£o-programadores</li>
                <li>ğŸ”„ Teste em tempo real</li>
                <li>ğŸ“Š MÃ©tricas de performance</li>
                <li>ğŸ’¾ Versionamento e backup</li>
            </ul>
            <p><strong>Acesso:</strong> <a href="https://tecnico.sisgov.app.br/ai-builder" target="_blank">https://tecnico.sisgov.app.br/ai-builder</a></p>
        </div>

        <div class="todo-item todo-pending">
            <h3>ğŸš€ PrÃ³ximas Fases - Sistema Multi-Agente</h3>
            <ul>
                <li>ğŸ¤– <strong>Arquitetura Multi-Agente Especializada</strong></li>
                <li>ğŸ“‹ PadrÃ£o JSON para comunicaÃ§Ã£o entre agentes</li>
                <li>ğŸ¯ Agente de CategorizaÃ§Ã£o â†’ Agente de Chamados â†’ Sistema de Protocolos</li>
                <li>ğŸ”„ Fluxo: Detecta problema â†’ Categoriza â†’ Abre chamado â†’ Gera protocolo</li>
                <li>âš¡ AvaliaÃ§Ã£o e possÃ­vel migraÃ§Ã£o para Agno Framework</li>
                <li>ğŸ“Š Interface web para gestores</li>
                <li>ğŸ“ˆ RelatÃ³rios avanÃ§ados e analytics</li>
                <li>ğŸ”” Sistema de notificaÃ§Ãµes automÃ¡ticas</li>
                <li>ğŸ‘¥ IntegraÃ§Ã£o completa com teams do Chatwoot</li>
                <li>ğŸ›ï¸ Suporte multi-prefeitura</li>
                <li>ğŸ“± App mobile para gestores</li>
                <li>ğŸ”— IntegraÃ§Ã£o com sistemas externos</li>
            </ul>
        </div>

        <div class="success">
            <h3>ğŸ‰ Resumo do Dia - 29/12/2024</h3>
            <p><strong>Hoje implementamos com sucesso:</strong></p>
            <ul>
                <li>âœ… <strong>CONSTRUTOR DE AGENTES IA</strong> - Interface visual completa</li>
                <li>âœ… Editor de prompts avanÃ§ado com syntax highlighting</li>
                <li>âœ… Simulador de conversa em tempo real</li>
                <li>âœ… Templates prÃ©-definidos por categoria</li>
                <li>âœ… APIs completas para gerenciamento de agentes</li>
                <li>âœ… Sistema de teste e mÃ©tricas de performance</li>
                <li>âœ… DocumentaÃ§Ã£o completa do construtor</li>
                <li>âœ… CorreÃ§Ã£o de validaÃ§Ã£o Pydantic</li>
                <li>âœ… Frontend administrativo funcionando</li>
                <li>âœ… Sistema de chamados operacional</li>
            </ul>
            <p><strong>Status:</strong> Sistema 100% funcional + Construtor de IA implementado! ğŸš€</p>
            <p><strong>PrÃ³ximo:</strong> Arquitetura Multi-Agente + AvaliaÃ§Ã£o Agno Framework</p>
        </div>

        <div style="text-align: center; margin-top: 40px; padding: 20px; background-color: #f8f9fa; border-radius: 10px;">
            <h3>ğŸ“ Suporte e Contato</h3>
            <p>Para dÃºvidas ou suporte tÃ©cnico, consulte:</p>
            <ul style="list-style: none; padding: 0;">
                <li>ğŸ“§ Email: suporte@sisgov.app.br</li>
                <li>ğŸŒ RepositÃ³rio: https://github.com/valleteclab/cidadaoai-chatwoot</li>
                <li>ğŸ“š DocumentaÃ§Ã£o: Este arquivo HTML</li>
            </ul>
            <p><em>DocumentaÃ§Ã£o gerada em: <strong id="current-date"></strong></em></p>
        </div>
    </div>

    <script>
        // Adicionar data atual
        document.getElementById('current-date').textContent = new Date().toLocaleDateString('pt-BR');
        
        // Smooth scroll para links internos
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    </script>
</body>
</html>
