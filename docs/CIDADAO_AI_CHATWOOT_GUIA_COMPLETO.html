<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cidad√£o.AI - Chatwoot - Guia Completo de Implementa√ß√£o</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
            text-align: center;
        }
        h2 {
            color: #34495e;
            border-left: 4px solid #3498db;
            padding-left: 15px;
            margin-top: 30px;
        }
        h3 {
            color: #2980b9;
            margin-top: 25px;
        }
        h4 {
            color: #7f8c8d;
            margin-top: 20px;
        }
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }
        .status-completed {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status-working {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .status-pending {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }
        .command {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 10px;
            border-radius: 5px;
            margin: 5px 0;
            font-family: 'Courier New', monospace;
        }
        .warning {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #ffc107;
        }
        .success {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #28a745;
        }
        .error {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #dc3545;
        }
        .architecture-diagram {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 10px;
        }
        .flow-step {
            background-color: #e3f2fd;
            border: 1px solid #bbdefb;
            border-radius: 5px;
            padding: 10px;
            margin: 5px 0;
            position: relative;
        }
        .flow-step::before {
            content: "‚Üí";
            position: absolute;
            left: -20px;
            color: #1976d2;
            font-weight: bold;
        }
        .tech-stack {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .tech-item {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }
        .endpoint {
            background-color: #f1f3f4;
            border: 1px solid #dadce0;
            border-radius: 5px;
            padding: 10px;
            margin: 5px 0;
            font-family: 'Courier New', monospace;
        }
        .endpoint .method {
            font-weight: bold;
            color: #1a73e8;
        }
        .endpoint .path {
            color: #137333;
        }
        .todo-list {
            background-color: #f8f9fa;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
        }
        .todo-item {
            margin: 8px 0;
            padding: 5px;
            border-radius: 3px;
        }
        .todo-completed {
            background-color: #d4edda;
            text-decoration: line-through;
            opacity: 0.7;
        }
        .todo-pending {
            background-color: #fff3cd;
        }
        .file-structure {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
        }
        .toc {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 20px;
            margin: 20px 0;
        }
        .toc ul {
            list-style-type: none;
            padding-left: 0;
        }
        .toc li {
            margin: 5px 0;
        }
        .toc a {
            text-decoration: none;
            color: #007bff;
        }
        .toc a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Cidad√£o.AI - Chatwoot Integration</h1>
        <h2 style="text-align: center; color: #27ae60; border: none;">Guia Completo de Implementa√ß√£o e Documenta√ß√£o</h2>
        
        <div class="success">
            <strong>‚úÖ Status do Projeto:</strong> Sistema funcionando perfeitamente! Todas as funcionalidades implementadas e testadas com sucesso.
        </div>

        <div class="toc">
            <h3>üìã √çndice</h3>
            <ul>
                <li><a href="#overview">1. Vis√£o Geral do Projeto</a></li>
                <li><a href="#architecture">2. Arquitetura do Sistema</a></li>
                <li><a href="#tech-stack">3. Stack Tecnol√≥gico</a></li>
                <li><a href="#features">4. Funcionalidades Implementadas</a></li>
                <li><a href="#api-endpoints">5. Endpoints da API</a></li>
                <li><a href="#deployment">6. Deploy e Configura√ß√£o</a></li>
                <li><a href="#troubleshooting">7. Solu√ß√£o de Problemas</a></li>
                <li><a href="#next-steps">8. Pr√≥ximos Passos</a></li>
                <li><a href="#appendix">9. Anexos T√©cnicos</a></li>
            </ul>
        </div>

        <h2 id="overview">1. üéØ Vis√£o Geral do Projeto</h2>
        
        <p>O <strong>Cidad√£o.AI - Chatwoot Integration</strong> √© um sistema completo que integra WhatsApp com Chatwoot para atendimento t√©cnico, permitindo:</p>
        
        <ul>
            <li><strong>Recebimento de mensagens</strong> do WhatsApp via Chatwoot</li>
            <li><strong>Interface web</strong> para t√©cnicos responderem mensagens</li>
            <li><strong>Processamento de m√≠dia</strong> (√°udio e imagens)</li>
            <li><strong>Integra√ß√£o com IA</strong> para respostas autom√°ticas</li>
            <li><strong>Atualiza√ß√µes em tempo real</strong> via WebSocket</li>
        </ul>

        <div class="architecture-diagram">
            <h3>üîÑ Fluxo Principal</h3>
            <div class="flow-step">WhatsApp ‚Üí Chatwoot</div>
            <div class="flow-step">Chatwoot ‚Üí Webhook (Cidad√£o.AI)</div>
            <div class="flow-step">Webhook ‚Üí Processamento de M√≠dia</div>
            <div class="flow-step">Processamento ‚Üí WebSocket (Frontend)</div>
            <div class="flow-step">T√©cnico ‚Üí Frontend ‚Üí Chatwoot ‚Üí WhatsApp</div>
        </div>

        <h2 id="architecture">2. üèóÔ∏è Arquitetura do Sistema</h2>

        <div class="file-structure">
cidadaoai-chatwoot/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ main.py                 # API principal e webhooks
‚îÇ   ‚îú‚îÄ‚îÄ websocket_manager.py    # Gerenciamento WebSocket
‚îÇ   ‚îú‚îÄ‚îÄ media_handler.py        # Processamento de √°udio
‚îÇ   ‚îú‚îÄ‚îÄ audio_transcriber.py    # Transcri√ß√£o com OpenAI Whisper
‚îÇ   ‚îú‚îÄ‚îÄ attachment_service.py   # Processamento de imagens
‚îÇ   ‚îú‚îÄ‚îÄ models.py              # Modelos Pydantic
‚îÇ   ‚îî‚îÄ‚îÄ database.py            # Conex√£o com banco
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îî‚îÄ‚îÄ tecnico/
‚îÇ       ‚îú‚îÄ‚îÄ index.html         # Interface principal
‚îÇ       ‚îî‚îÄ‚îÄ js/
‚îÇ           ‚îú‚îÄ‚îÄ app.js         # L√≥gica do frontend
‚îÇ           ‚îî‚îÄ‚îÄ config.js      # Configura√ß√µes
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îî‚îÄ‚îÄ schema.sql            # Schema do banco
‚îú‚îÄ‚îÄ docker-compose.yml        # Configura√ß√£o Docker
‚îú‚îÄ‚îÄ Dockerfile               # Imagem Docker
‚îú‚îÄ‚îÄ requirements.txt         # Depend√™ncias Python
‚îî‚îÄ‚îÄ .env                    # Vari√°veis de ambiente
        </div>

        <h2 id="tech-stack">3. üõ†Ô∏è Stack Tecnol√≥gico</h2>

        <div class="tech-stack">
            <div class="tech-item">
                <h4>Backend</h4>
                <ul>
                    <li><strong>FastAPI</strong> - Framework web moderno</li>
                    <li><strong>Python 3.11</strong> - Linguagem principal</li>
                    <li><strong>Socket.IO</strong> - WebSocket para tempo real</li>
                    <li><strong>httpx</strong> - Cliente HTTP ass√≠ncrono</li>
                </ul>
            </div>
            <div class="tech-item">
                <h4>Frontend</h4>
                <ul>
                    <li><strong>HTML5 + CSS3</strong> - Interface web</li>
                    <li><strong>Tailwind CSS</strong> - Framework CSS</li>
                    <li><strong>JavaScript ES6+</strong> - L√≥gica frontend</li>
                    <li><strong>Socket.IO Client</strong> - Comunica√ß√£o real-time</li>
                </ul>
            </div>
            <div class="tech-item">
                <h4>Infraestrutura</h4>
                <ul>
                    <li><strong>Docker + Docker Swarm</strong> - Containeriza√ß√£o</li>
                    <li><strong>PostgreSQL + pgvector</strong> - Banco de dados</li>
                    <li><strong>Redis</strong> - Cache e sess√µes</li>
                    <li><strong>Traefik</strong> - Proxy reverso</li>
                </ul>
            </div>
            <div class="tech-item">
                <h4>Integra√ß√µes</h4>
                <ul>
                    <li><strong>Chatwoot API</strong> - Sistema de chat</li>
                    <li><strong>OpenAI Whisper</strong> - Transcri√ß√£o de √°udio</li>
                    <li><strong>WhatsApp Business API</strong> - Mensagens</li>
                    <li><strong>FFmpeg</strong> - Processamento de m√≠dia</li>
                </ul>
            </div>
        </div>

        <h2 id="features">4. ‚ú® Funcionalidades Implementadas</h2>

        <h3>4.1 Sistema de Mensagens <span class="status-badge status-completed">‚úÖ COMPLETO</span></h3>
        <ul>
            <li>‚úÖ Recebimento de mensagens via webhook do Chatwoot</li>
            <li>‚úÖ Envio de mensagens para Chatwoot/WhatsApp</li>
            <li>‚úÖ Interface web para t√©cnicos</li>
            <li>‚úÖ Atualiza√ß√µes em tempo real via WebSocket</li>
        </ul>

        <h3>4.2 Processamento de √Åudio <span class="status-badge status-completed">‚úÖ COMPLETO</span></h3>
        <ul>
            <li>‚úÖ Download autom√°tico de √°udios do Chatwoot</li>
            <li>‚úÖ Player de √°udio no frontend</li>
            <li>‚úÖ Grava√ß√£o via microfone no frontend</li>
            <li>‚úÖ Convers√£o para formatos compat√≠veis com WhatsApp</li>
            <li>‚úÖ Transcri√ß√£o com OpenAI Whisper (configur√°vel)</li>
        </ul>

        <h3>4.3 Processamento de Imagens <span class="status-badge status-completed">‚úÖ COMPLETO</span></h3>
        <ul>
            <li>‚úÖ Detec√ß√£o autom√°tica de imagens nos webhooks</li>
            <li>‚úÖ Exibi√ß√£o de imagens no frontend</li>
            <li>‚úÖ Upload de imagens via frontend</li>
            <li>‚úÖ Persist√™ncia de imagens ao trocar conversas</li>
            <li>‚úÖ Modal para visualiza√ß√£o em tela cheia</li>
        </ul>

        <h3>4.4 Interface Web <span class="status-badge status-completed">‚úÖ COMPLETO</span></h3>
        <ul>
            <li>‚úÖ Lista de conversas em tempo real</li>
            <li>‚úÖ Chat interface responsiva</li>
            <li>‚úÖ Indicadores de status (enviado, entregue, lido)</li>
            <li>‚úÖ Busca e filtros de conversas</li>
            <li>‚úÖ Interface para envio de m√≠dia</li>
        </ul>

        <h3>4.5 Integra√ß√£o com IA <span class="status-badge status-completed">‚úÖ COMPLETO</span></h3>
        <ul>
            <li>‚úÖ Processamento autom√°tico de mensagens</li>
            <li>‚úÖ Respostas autom√°ticas via OpenAI</li>
            <li>‚úÖ Transcri√ß√£o de √°udio com Whisper</li>
            <li>‚úÖ Configura√ß√£o flex√≠vel de prompts</li>
        </ul>

        <h2 id="api-endpoints">5. üîå Endpoints da API</h2>

        <h3>5.1 Endpoints Principais</h3>
        
        <div class="endpoint">
            <span class="method">GET</span> <span class="path">/</span> - P√°gina principal (frontend)
        </div>
        
        <div class="endpoint">
            <span class="method">GET</span> <span class="path">/health</span> - Status da API
        </div>
        
        <div class="endpoint">
            <span class="method">POST</span> <span class="path">/webhook/chatwoot</span> - Webhook do Chatwoot
        </div>

        <h3>5.2 API para Frontend</h3>
        
        <div class="endpoint">
            <span class="method">GET</span> <span class="path">/api/conversations</span> - Listar conversas
        </div>
        
        <div class="endpoint">
            <span class="method">GET</span> <span class="path">/api/conversations/{id}/messages</span> - Mensagens da conversa
        </div>
        
        <div class="endpoint">
            <span class="method">POST</span> <span class="path">/api/conversations/{id}/messages</span> - Enviar mensagem
        </div>
        
        <div class="endpoint">
            <span class="method">POST</span> <span class="path">/api/conversations/{id}/voice</span> - Enviar √°udio
        </div>
        
        <div class="endpoint">
            <span class="method">POST</span> <span class="path">/api/conversations/{id}/image</span> - Enviar imagem
        </div>

        <h3>5.3 WebSocket Events</h3>
        
        <div class="code-block">
// Eventos enviados pelo servidor:
- new_message: Nova mensagem recebida
- conversation_update: Atualiza√ß√£o de conversa
- typing_status: Status de digita√ß√£o

// Eventos enviados pelo cliente:
- join_conversation: Entrar em uma conversa
- leave_conversation: Sair de uma conversa
        </div>

        <h2 id="deployment">6. üöÄ Deploy e Configura√ß√£o</h2>

        <h3>6.1 Configura√ß√£o do Ambiente</h3>

        <div class="command">
# 1. Clonar reposit√≥rio
git clone https://github.com/valleteclab/cidadaoai-chatwoot.git
cd cidadaoai-chatwoot

# 2. Configurar vari√°veis de ambiente
cp env.template .env
# Editar .env com suas configura√ß√µes
        </div>

        <h3>6.2 Vari√°veis de Ambiente Necess√°rias</h3>

        <div class="code-block">
# Chatwoot
CHATWOOT_API_URL=https://chat.sisgov.app.br
CHATWOOT_API_TOKEN=seu_token_aqui
CHATWOOT_ACCOUNT_ID=1

# OpenAI (opcional)
OPENAI_API_KEY=sk-proj-...

# Banco de dados
DATABASE_URL=postgresql://user:pass@host:port/db

# Redis
REDIS_URL=redis://host:port

# Servidor
HOST=0.0.0.0
PORT=8000
        </div>

        <h3>6.3 Deploy com Docker Swarm</h3>

        <div class="command">
# 1. Fazer build da imagem
docker build -t cidadaoai:latest .

# 2. Deploy do stack
docker stack deploy -c docker-compose.yml cidadaoai

# 3. Verificar status
docker service ls --filter name=cidadaoai
        </div>

        <h3>6.4 Configura√ß√£o do Chatwoot</h3>

        <div class="warning">
            <strong>‚ö†Ô∏è Importante:</strong> Configure o webhook no Chatwoot apontando para:
            <br><code>https://tecnico.sisgov.app.br/webhook/chatwoot</code>
        </div>

        <h2 id="troubleshooting">7. üîß Solu√ß√£o de Problemas</h2>

        <h3>7.1 Problemas Comuns e Solu√ß√µes</h3>

        <div class="error">
            <h4>‚ùå Erro: "ModuleNotFoundError: No module named 'backend'"</h4>
            <p><strong>Solu√ß√£o:</strong> Execute o update no servidor:</p>
            <div class="command">./update-server.sh</div>
        </div>

        <div class="error">
            <h4>‚ùå Erro: "ValidationError: conversation_id Input should be a valid integer"</h4>
            <p><strong>Solu√ß√£o:</strong> J√° corrigido - modelo ChatwootAttachment atualizado.</p>
        </div>

        <div class="error">
            <h4>‚ùå Imagens n√£o aparecem ao trocar de conversas</h4>
            <p><strong>Solu√ß√£o:</strong> J√° corrigido - API agora retorna image_attachments.</p>
        </div>

        <h3>7.2 Logs Importantes</h3>

        <div class="code-block">
# Verificar logs do servi√ßo
docker service logs -f cidadaoai_cidadaoai_app

# Logs importantes para debug:
- "‚úÖ Attachment detectado como imagem por MIME: image"
- "üñºÔ∏è Processadas X imagens para mensagem Y"
- "üì® Nova mensagem recebida via WebSocket"
        </div>

        <h3>7.3 Comandos de Debug</h3>

        <div class="command">
# Testar conectividade da API
curl https://tecnico.sisgov.app.br/health

# Verificar status do servi√ßo
docker service ps cidadaoai_cidadaoai_app

# Rebuild da imagem
docker build -t cidadaoai:latest .
docker service update --image cidadaoai:latest cidadaoai_cidadaoai_app
        </div>

        <h2 id="next-steps">8. üéØ Pr√≥ximos Passos</h2>

        <div class="todo-list">
            <h3>Tarefas Pendentes</h3>
            
            <div class="todo-item todo-pending">
                <h4>üîß Melhorias T√©cnicas</h4>
                <ul>
                    <li>Implementar cache Redis para melhor performance</li>
                    <li>Adicionar autentica√ß√£o/autoriza√ß√£o</li>
                    <li>Implementar rate limiting</li>
                    <li>Adicionar logs estruturados (JSON)</li>
                </ul>
            </div>

            <div class="todo-item todo-pending">
                <h4>üì± Funcionalidades</h4>
                <ul>
                    <li>Suporte a outros tipos de m√≠dia (v√≠deo, documentos)</li>
                    <li>Notifica√ß√µes push para novas mensagens</li>
                    <li>Hist√≥rico de conversas com pagina√ß√£o</li>
                    <li>Exporta√ß√£o de relat√≥rios</li>
                </ul>
            </div>

            <div class="todo-item todo-pending">
                <h4>üé® Interface</h4>
                <ul>
                    <li>Modo escuro/claro</li>
                    <li>Personaliza√ß√£o de temas</li>
                    <li>Atalhos de teclado</li>
                    <li>Interface mobile otimizada</li>
                </ul>
            </div>

            <div class="todo-item todo-pending">
                <h4>ü§ñ IA Avan√ßada</h4>
                <ul>
                    <li>An√°lise de sentimento das mensagens</li>
                    <li>Classifica√ß√£o autom√°tica de tickets</li>
                    <li>Respostas baseadas em contexto</li>
                    <li>Integra√ß√£o com outros modelos de IA</li>
                </ul>
            </div>
        </div>

        <h2 id="appendix">9. üìö Anexos T√©cnicos</h2>

        <h3>9.1 Estrutura do Banco de Dados</h3>

        <div class="code-block">
-- Tabela para armazenar mensagens
CREATE TABLE messages (
    id SERIAL PRIMARY KEY,
    chatwoot_message_id INTEGER UNIQUE,
    conversation_id INTEGER,
    content TEXT,
    message_type VARCHAR(50),
    sender_type VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Tabela para attachments processados
CREATE TABLE attachments (
    id SERIAL PRIMARY KEY,
    chatwoot_attachment_id INTEGER,
    message_id INTEGER,
    file_type VARCHAR(100),
    filename VARCHAR(255),
    file_size INTEGER,
    data_url TEXT,
    processed_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
        </div>

        <h3>9.2 Configura√ß√£o do Traefik</h3>

        <div class="code-block">
# Labels para Docker Swarm
traefik.enable=true
traefik.http.routers.cidadaoai.rule=Host(`tecnico.sisgov.app.br`)
traefik.http.routers.cidadaoai.entrypoints=websecure
traefik.http.routers.cidadaoai.tls.certresolver=letsencrypt
traefik.http.services.cidadaoai.loadbalancer.server.port=8000
        </div>

        <h3>9.3 Scripts √öteis</h3>

        <h4>Comandos para Acesso ao Servidor</h4>
        <div class="code-block">
# Acessar o servidor
ssh root@212.85.0.166

# Navegar para o diret√≥rio do projeto
cd /root/projetos/cidadaoai-chatwoot

# Ativar ambiente virtual (se necess√°rio)
source venv/bin/activate

# Executar atualiza√ß√£o do servidor
./update-server.sh
        </div>

        <h4>update-server.sh</h4>
        <div class="code-block">
#!/bin/bash
# Script para atualizar o servi√ßo no Docker Swarm

SERVICE_NAME="cidadaoai_cidadaoai_app"
STACK_NAME="cidadaoai"
IMAGE_NAME="cidadaoai:latest"

echo "üöÄ Iniciando atualiza√ß√£o do servi√ßo $SERVICE_NAME..."

# 1. Parar e remover o servi√ßo existente
docker service rm $SERVICE_NAME || true

# 2. Fazer git pull
git pull origin main

# 3. Reconstruir a imagem Docker
docker build -t $IMAGE_NAME .

# 4. Deploy do stack atualizado
docker stack deploy -c docker-compose.yml $STACK_NAME

# 5. Verificar status
docker service ls --filter name=$SERVICE_NAME

echo "üéâ Atualiza√ß√£o conclu√≠da!"
        </div>

        <h4>Processo Completo de Deploy</h4>
        <div class="code-block">
# 1. Local - Commit e Push das mudan√ßas
git add .
git commit -m "Descri√ß√£o das mudan√ßas"
git push origin main

# 2. Servidor - SSH e Deploy
ssh root@212.85.0.166
cd /root/projetos/cidadaoai-chatwoot
git pull origin main
./update-server.sh

# 3. Verificar status do servi√ßo
docker service ls --filter name=cidadaoai

# 4. Ver logs em tempo real
docker service logs -f cidadaoai_cidadaoai_app
        </div>

        <h4>Monitoramento da IA</h4>
        <div class="code-block">
# Verificar status da IA (recomendado)
./check_ai_status.sh

# Monitorar apenas logs da IA (filtrado)
./monitor_ai_logs.sh

# Verificar status via API
curl https://tecnico.sisgov.app.br/api/agent/status

# Debug completo da IA
curl https://tecnico.sisgov.app.br/api/agent/debug
        </div>

        <h3>9.4 Monitoramento</h3>

        <div class="code-block">
# Comandos para monitoramento
docker service logs -f cidadaoai_cidadaoai_app
docker service ps cidadaoai_cidadaoai_app
docker stats $(docker ps -q --filter "name=cidadaoai")

# M√©tricas importantes:
- Uso de CPU e mem√≥ria
- Lat√™ncia das requisi√ß√µes
- Taxa de erro dos webhooks
- N√∫mero de conex√µes WebSocket ativas
        </div>

        <h3>9.5 Backup e Recupera√ß√£o</h3>

        <div class="code-block">
# Backup do banco de dados
docker exec cidadaoai_postgres pg_dump -U postgres cidadaoai > backup_$(date +%Y%m%d_%H%M%S).sql

# Backup dos arquivos de m√≠dia
tar -czf media_backup_$(date +%Y%m%d_%H%M%S).tar.gz ./media/

# Restaurar backup
docker exec -i cidadaoai_postgres psql -U postgres cidadaoai < backup_file.sql
        </div>

        <div class="todo-item todo-completed">
            <h3>üé´ Sistema de Chamados Cidad√£os - FASE 1 ‚úÖ</h3>
            <p><strong>Implementado em 28/12/2024:</strong></p>
            <ul>
                <li>‚úÖ Schema completo do banco de dados</li>
                <li>‚úÖ Sistema de cadastro autom√°tico de cidad√£os</li>
                <li>‚úÖ Gera√ß√£o autom√°tica de protocolos √∫nicos</li>
                <li>‚úÖ Categoriza√ß√£o inteligente de chamados</li>
                <li>‚úÖ IA especializada para fluxo de atendimento</li>
                <li>‚úÖ Endpoints completos de API</li>
                <li>‚úÖ Integra√ß√£o com sistema existente</li>
                <li>‚úÖ Frontend administrativo</li>
                <li>‚úÖ Documenta√ß√£o completa</li>
            </ul>
            <p><strong>Funcionalidades:</strong></p>
            <ul>
                <li>ü§ñ IA coleta dados do cidad√£o automaticamente</li>
                <li>üìã Cria protocolos √∫nicos (ex: INFRA-2024-001)</li>
                <li>üè¢ Categoriza chamados por secretaria</li>
                <li>‚è∞ Define SLA autom√°tico por categoria</li>
                <li>üìä Dashboard com m√©tricas em tempo real</li>
                <li>üîç Consulta de status via WhatsApp</li>
                <li>üñ•Ô∏è Interface administrativa completa</li>
            </ul>
            <p><strong>Documenta√ß√£o:</strong></p>
            <ul>
                <li><a href="docs/MANUAL_COMPLETO_SISTEMA.md" target="_blank">üìö Manual Completo do Sistema</a></li>
                <li><a href="docs/TROUBLESHOOTING.md" target="_blank">üîß Guia de Troubleshooting</a></li>
                <li><a href="COMANDOS_RAPIDOS.md" target="_blank">‚ö° Comandos R√°pidos</a></li>
                <li><a href="docs/MANUAL_IMPLEMENTACAO_FASE1.md" target="_blank">üìã Manual de Implementa√ß√£o</a></li>
            </ul>
        </div>

        <div class="todo-item todo-pending">
            <h3>üöÄ Pr√≥ximas Fases - Sistema de Chamados</h3>
            <ul>
                <li>üìä Interface web para gestores</li>
                <li>üìà Relat√≥rios avan√ßados e analytics</li>
                <li>üîî Sistema de notifica√ß√µes autom√°ticas</li>
                <li>üë• Integra√ß√£o completa com teams do Chatwoot</li>
                <li>‚úèÔ∏è Editor de templates din√¢micos</li>
                <li>üèõÔ∏è Suporte multi-prefeitura</li>
                <li>üì± App mobile para gestores</li>
                <li>üîó Integra√ß√£o com sistemas externos</li>
            </ul>
        </div>

        <div class="success">
            <h3>üéâ Resumo do Dia</h3>
            <p><strong>Hoje implementamos com sucesso:</strong></p>
            <ul>
                <li>‚úÖ Sistema completo de processamento de imagens</li>
                <li>‚úÖ Corre√ß√£o de bugs cr√≠ticos no modelo de dados</li>
                <li>‚úÖ Persist√™ncia de imagens ao trocar conversas</li>
                <li>‚úÖ WebSocket funcionando perfeitamente</li>
                <li>‚úÖ Frontend renderizando m√≠dia corretamente</li>
                <li>‚úÖ API retornando dados completos</li>
                <li>‚úÖ <strong>SISTEMA COMPLETO DE CHAMADOS CIDAD√ÉOS</strong></li>
            </ul>
            <p><strong>Status:</strong> Sistema 100% funcional + Sistema de Chamados implementado! üöÄ</p>
        </div>

        <div style="text-align: center; margin-top: 40px; padding: 20px; background-color: #f8f9fa; border-radius: 10px;">
            <h3>üìû Suporte e Contato</h3>
            <p>Para d√∫vidas ou suporte t√©cnico, consulte:</p>
            <ul style="list-style: none; padding: 0;">
                <li>üìß Email: suporte@sisgov.app.br</li>
                <li>üåê Reposit√≥rio: https://github.com/valleteclab/cidadaoai-chatwoot</li>
                <li>üìö Documenta√ß√£o: Este arquivo HTML</li>
            </ul>
            <p><em>Documenta√ß√£o gerada em: <strong id="current-date"></strong></em></p>
        </div>
    </div>

    <script>
        // Adicionar data atual
        document.getElementById('current-date').textContent = new Date().toLocaleDateString('pt-BR');
        
        // Smooth scroll para links internos
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    </script>
</body>
</html>
